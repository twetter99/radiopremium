<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="RadioPremium.App.Views.FavoritesPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="using:RadioPremium.App.Converters"
    Background="{StaticResource BackgroundSecondaryBrush}">

    <Page.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </Page.Resources>

    <Grid Padding="24,40,24,24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock 
                Text="Mis Favoritos"
                Style="{ThemeResource TitleLargeTextBlockStyle}" />
            <TextBlock 
                Text="{x:Bind ViewModel.Favorites.Count, Mode=OneWay}"
                Style="{ThemeResource CaptionTextBlockStyle}"
                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
        </StackPanel>

        <!-- Loading -->
        <ProgressRing 
            Grid.Row="1"
            IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
            Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
            HorizontalAlignment="Center"
            VerticalAlignment="Center" />

        <!-- Favorites List -->
        <ListView 
            Grid.Row="1"
            ItemsSource="{x:Bind ViewModel.Favorites}"
            SelectionMode="None"
            Visibility="{x:Bind ViewModel.HasFavorites, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
            
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid 
                        Padding="12"
                        Margin="0,4"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8">
                        
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!-- Station Logo -->
                        <Border 
                            Grid.Column="0"
                            Width="48"
                            Height="48"
                            CornerRadius="8"
                            Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                            Margin="0,0,12,0">
                            <Grid>
                                <Image 
                                    Source="{Binding Favicon}"
                                    Stretch="UniformToFill" />
                                <FontIcon 
                                    Glyph="&#xE95A;"
                                    FontSize="20"
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                            </Grid>
                        </Border>

                        <!-- Station Info -->
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock 
                                Text="{Binding Name}"
                                Style="{ThemeResource BodyStrongTextBlockStyle}"
                                TextTrimming="CharacterEllipsis" />
                            <TextBlock 
                                Text="{Binding Country}"
                                Style="{ThemeResource CaptionTextBlockStyle}"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        </StackPanel>

                        <!-- Remove Button -->
                        <Button 
                            Grid.Column="2"
                            Tag="{Binding}"
                            Click="RemoveFavorite_Click"
                            Style="{StaticResource IconButtonStyle}"
                            ToolTipService.ToolTip="Eliminar de favoritos">
                            <FontIcon 
                                Glyph="&#xE74D;"
                                FontSize="16"
                                Foreground="{ThemeResource SystemFillColorCriticalBrush}" />
                        </Button>

                        <!-- Play Button -->
                        <Button 
                            Grid.Column="3"
                            Tag="{Binding}"
                            Click="PlayStation_Click"
                            Style="{StaticResource AccentButtonStyle}">
                            <FontIcon Glyph="&#xE768;" FontSize="14" />
                        </Button>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Empty State -->
        <StackPanel 
            Grid.Row="1"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Visibility="{x:Bind ViewModel.HasFavorites, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}">
            <FontIcon 
                Glyph="&#xE735;"
                FontSize="64"
                Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                Margin="0,0,0,16" />
            <TextBlock 
                Text="No tienes emisoras favoritas"
                Style="{ThemeResource SubtitleTextBlockStyle}"
                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                HorizontalAlignment="Center" />
            <TextBlock 
                Text="Añade emisoras desde la página de Radio"
                Style="{ThemeResource CaptionTextBlockStyle}"
                Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                HorizontalAlignment="Center"
                Margin="0,8,0,0" />
        </StackPanel>
    </Grid>
</Page>
